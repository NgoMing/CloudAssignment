{"paragraphs":[{"text":"val keySpace = \"cass_db\"\r\nval table = \"sales_join_price\"\r\n\r\nval fullTable = sqlContext.read.format(\"org.apache.spark.sql.cassandra\").options(Map(\"keyspace\" -> keySpace, \"table\" -> table)).load()\r\nfullTable.createOrReplaceTempView(table)","dateUpdated":"2018-10-11T18:57:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"keySpace: String = cass_db\ntable: String = sales_join_price\nfullTable: org.apache.spark.sql.DataFrame = [student_name: string, course_name: string ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1539284233686_555036134","id":"20181009-160413_1535656301","dateCreated":"2018-10-11T18:57:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5436"},{"text":"// retrieve records of one partition. \r\nval onePartition = fullTable.select($\"course_name\", $\"rate\") \r\n\r\nz.show(onePartition)","dateUpdated":"2018-10-11T18:57:13+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"onePartition: org.apache.spark.sql.DataFrame = [course_name: string, rate: int]\n"},{"type":"TABLE","data":"course_name\trate\nBig Data Analysis\t5\nCloud Implementation\t3\nJava Programming\t3\nJavaScript Programming\t3\nMachine Learning\t5\nPerl Programming\t4\nPython Programming\t4\nC Programming\t2\nCloud Implementation\t3\nJava Programming\t5\nPerl Programming\t5\nPython Programming\t3\nC Programming\t2\nJava Programming\t3\nPython Programming\t3\nWeb Development\t5\n"}]},"apps":[],"jobName":"paragraph_1539284233687_554651385","id":"20181009-160940_865153544","dateCreated":"2018-10-11T18:57:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5437"},{"text":"val average = onePartition.as[(String,Float)].map{\r\n    case (course_name, rate) => (course_name, (1, rate))\r\n}.rdd.reduceByKey{\r\n    (a,b) => (a._1+b._1, a._2+b._2)\r\n}.map{\r\n    case (course_name, (count, sum)) => (course_name, sum/count)\r\n}\r\n\r\nval columnNames = Array(\"course\", \"avg_rate\")\r\n\r\nz.show(average.toDF(columnNames:_*))","dateUpdated":"2018-10-11T18:57:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"average: org.apache.spark.rdd.RDD[(String, Float)] = MapPartitionsRDD[12] at map at <console>:39\ncolumnNames: Array[String] = Array(course, avg_rate)\n"},{"type":"TABLE","data":"course\tavg_rate\nPerl Programming\t4.5\nJava Programming\t3.6666667\nWeb Development\t5.0\nBig Data Analysis\t5.0\nPython Programming\t3.3333333\nMachine Learning\t5.0\nCloud Implementation\t3.0\nJavaScript Programming\t3.0\nC Programming\t2.0\n"}]},"apps":[],"jobName":"paragraph_1539284233687_554651385","id":"20181011-022927_279323784","dateCreated":"2018-10-11T18:57:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5438"},{"text":"val course_average_rate = average.toDF(columnNames:_*).select($\"course\".as(\"course_name\"), $\"avg_rate\".as(\"average_rate\"))\n\ncourse_average_rate.write\n    .format(\"org.apache.spark.sql.cassandra\")\n    .mode(\"append\")\n    .options(Map(\"keyspace\" -> keySpace, \"table\" -> \"course\"))\n    .save()","dateUpdated":"2018-10-11T18:57:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"course_average_rate: org.apache.spark.sql.DataFrame = [course_name: string, average_rate: float]\n"}]},"apps":[],"jobName":"paragraph_1539284233687_554651385","id":"20181011-121832_1417679306","dateCreated":"2018-10-11T18:57:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5439"},{"dateUpdated":"2018-10-11T18:57:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1539284233687_554651385","id":"20181011-122256_302853651","dateCreated":"2018-10-11T18:57:13+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5440"}],"name":"Use Spark “map”, “reduce” to calculate average","id":"2DTDAD8EF","angularObjects":{"2DTK7AA14:shared_process":[],"2DSS31H6A:shared_process":[],"2DT7GJZ8V:shared_process":[],"2DRSKM9ZX:shared_process":[],"2DUH47XBY:shared_process":[],"2DV8FD7UN:shared_process":[],"2DTTC38K1:shared_process":[],"2DTYBY2Z2:shared_process":[],"2DUVHUCYS:shared_process":[],"2DUFAMVE8:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false","cronExecutingUser":"anonymous","cron":"0 0/5 * * * ?"},"info":{}}